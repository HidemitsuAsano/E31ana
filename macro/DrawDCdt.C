//H.Asano 
//This is a ROOT macro to draw TDC and drift time distribution of drift chambers.
//input: output files generated by EventAnalysisXT.cpp

void DrawDCdt(const char* filename){
  TFile *f1 = new TFile(filename,"READ");
  if(!f1) return;
  gROOT->SetStyle("Plain");

  const char dcname[256][6]={"BLC1a","BLC1b","BLC2a","BLC2b","BPC","FDC1"};
  int nlayer[6]      ={      8,      8,      8,      8,    8,    6};
  gStyle->SetOptStat("em");
  TCanvas *c[6];
  for(int idc=0;idc<6;idc++){
    c[idc] = new TCanvas(Form("c%s",dcname[idc]),Form("c%s",dcname[idc]),800,800);
    c[idc]->Divide(4,2);

    for(int ilr=0;ilr<nlayer[idc];ilr++){
      char hname[256];
      sprintf(hname,"T%s_%d",dcname[idc],ilr+1);
      //std::cout << hname << std::endl;
      c[idc]->cd(ilr+1);
      TH1F *htemp = (TH1F*)f1->Get(hname);
      htemp->SetLineColor(1);
      if(idc==0) htemp->GetXaxis()->SetRangeUser(500,2000);
      if(idc==1) htemp->GetXaxis()->SetRangeUser(500,2000);
      if(idc==2) htemp->GetXaxis()->SetRangeUser(0,1500);
      if(idc==3){
        if(ilr==0 || ilr==8) htemp->GetXaxis()->SetRangeUser(0,1500);
        else                 htemp->GetXaxis()->SetRangeUser(500,2000);
      }
      if(idc==4) htemp->GetXaxis()->SetRangeUser(0,1500);
      if(idc==5) htemp->GetXaxis()->SetRangeUser(0,1000);
      
      htemp->Draw();
      sprintf(hname,"T%s_%d_mul1",dcname[idc],ilr+1);
      TH1F *htemp2 = (TH1F*)f1->Get(hname);
      htemp2->SetLineColor(2);
      htemp2->Draw("same");
    }
    char picname[256];
    sprintf(picname,"TDC%s.pdf",dcname[idc]);
    c[idc]->SaveAs(picname,"PDG");
  }
  
  TCanvas *c2[6];
  for(int idc=0;idc<6;idc++){
    c2[idc] = new TCanvas(Form("cd%s",dcname[idc]),Form("cd%s",dcname[idc]),800,800);
    c2[idc]->Divide(4,2);

    for(int ilr=0;ilr<nlayer[idc];ilr++){
      char hname[256];
      sprintf(hname,"d%s_%d",dcname[idc],ilr+1);
      //std::cout << hname << std::endl;
      c2[idc]->cd(ilr+1);
      TH1F *htemp = (TH1F*)f1->Get(hname);
      if(idc==0) htemp->GetXaxis()->SetRangeUser(-300,500);
      if(idc==1) htemp->GetXaxis()->SetRangeUser(-300,500);
      if(idc==2) htemp->GetXaxis()->SetRangeUser(-400,500);
      if(idc==3) htemp->GetXaxis()->SetRangeUser(-500,500);
      if(idc==4){
        if(ilr==4 || ilr==5 || ilr==6) htemp->GetXaxis()->SetRangeUser(500,1500);
        else                           htemp->GetXaxis()->SetRangeUser(-300,500);
      }
      if(idc==5) htemp->GetXaxis()->SetRangeUser(-200,500);
      
      htemp->SetLineColor(1);
      htemp->Draw();
      int ent = htemp->GetEntries();
      sprintf(hname,"d%s_%d_mul1",dcname[idc],ilr+1);
      TH1F *htemp2 = (TH1F*)f1->Get(hname);
      htemp2->SetLineColor(2);
      htemp2->Draw("same");
      int ent2= htemp2->GetEntries();
      cout << dcname[idc] << " layer" << ilr+1 << " w/o cut:" << ent << " w/ cut:" << ent2 << " frac. " << (double) ent2/ent << endl;
    }
    
    char picname[256];
    sprintf(picname,"dt%s.pdf",dcname[idc]);
    c2[idc]->SaveAs(picname,"PDG");
  }
  
  /*
  TCanvas *ccdc = new TCanvas("cCDC","cCDC",800,800);
  ccdc->Divide(4,4);
  for(int ilr=0;ilr<15;ilr++){
    char hname[256];
    sprintf(hname,"MulCDC_%d",ilr+1);
    ccdc->cd(ilr+1);
    TH1F *htemp = (TH1F*)f1->Get(hname);
    htemp->Draw();
  }*/


}
